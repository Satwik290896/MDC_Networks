clear all;
Model3 = [0.970424 0.859569 0.745601 0.615185 0.460583 0.281835 0.147792 0.040206 0.000000;0.299277 0.351606 0.281921 0.217093 0.155006 0.084058 0.021911 0.000000 0.000000;0.755972 0.595743 0.476361 0.364253 0.251456 0.148264 0.056798 0.000647 0.000000;0.841503 0.699774 0.577824 0.463032 0.355149 0.246058 0.143258 0.048653 0.000000;0.879511 0.768924 0.666737 0.544092 0.419882 0.306517 0.198660 0.104131 0.016641;0.895765 0.775252 0.686686 0.584544 0.472507 0.366919 0.273214 0.181261 0.090687;0.912372 0.803303 0.718068 0.613686 0.501892 0.387740 0.291535 0.203797 0.125392;0.878565 0.767701 0.671697 0.564317 0.450973 0.346457 0.258611 0.162813 0.074608;0.960952 0.847098 0.763654 0.670962 0.552699 0.432879 0.336615 0.235389 0.140114;0.899788 0.751122 0.647257 0.523561 0.391815 0.263979 0.158626 0.062631 0.000806;1.000000 0.991186 0.910212 0.801595 0.676282 0.513398 0.366431 0.249730 0.133123;0.996703 0.925507 0.847179 0.731087 0.609466 0.473836 0.372625 0.285157 0.195102;0.974119 0.880601 0.779978 0.652215 0.486789 0.300922 0.168826 0.057201 0.000000;0.942082 0.827651 0.740281 0.643482 0.527347 0.389861 0.272250 0.187234 0.09407;0.970424 0.859569 0.745601 0.615185 0.460583 0.281835 0.147792 0.040206 0.000000;0.901304 0.750804 0.651063 0.514702 0.358836 0.214626 0.116714 0.021005 0.000000;0.910502 0.821189 0.730155 0.617637 0.479544 0.332474 0.232457 0.131748 0.043429;0.996554 0.940553 0.837312 0.725592 0.582449 0.406048 0.297255 0.191491 0.087935;0.967257 0.868397 0.789312 0.690930 0.577148 0.443009 0.293962 0.206306 0.106205;0.984013 0.856488 0.751745 0.633367 0.491389 0.291448 0.106224 0.005037 0.000000;0.999908 0.967404 0.866474 0.749581 0.601186 0.406976 0.210557 0.086166 0.002041;0.830716 0.654236 0.513540 0.317357 0.174345 0.057601 0.000000 0.000000 0.000000;0.987411 0.692304 0.546338 0.378196 0.198547 0.080078 0.001325 0.000000 0.000000;0.955504 0.678574 0.464057 0.237480 0.056226 0.000000 0.000000 0.000000 0.000000;0.967146 0.648665 0.489426 0.300899 0.083076 0.000205 0.000000 0.000000 0.000000;0.982613 0.828894 0.627634 0.428702 0.211220 0.071325 0.000385 0.000000 0.000000;0.877800 0.591725 0.489275 0.336501 0.139756 0.039061 0.000168 0.000000 0.000000;0.793287 0.711398 0.571663 0.454240 0.308284 0.141786 0.046507 0.000456 0.000000;0.997442 0.856717 0.706265 0.514963 0.333684 0.120623 0.000924 0.000000 0.000000;0.334947 0.123858 0.004685 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000;1.000000 1.000000 1.000000 0.751009 0.704875 0.541882 0.295504 0.020204 0.000000;0.334924 0.120482 0.000309 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000]';
Model2 = [0.129893 0.030388 0.000176 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000;0.162431 0.080665 0.004967 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000;0.727853 0.563812 0.447024 0.344131 0.244094 0.148135 0.056866 0.000307 0.000000;0.893216 0.742192 0.652993 0.558950 0.464083 0.373996 0.288391 0.209450 0.124659;0.927678 0.863003 0.796060 0.717666 0.623969 0.535076 0.455255 0.380944 0.304219;0.986697 0.869714 0.768383 0.650992 0.502594 0.354989 0.220447 0.106932 0.010300;0.954795 0.794104 0.705160 0.612182 0.495378 0.380275 0.279297 0.180901 0.087138;0.893521 0.807113 0.718650 0.611747 0.498381 0.398528 0.313111 0.230438 0.141549;0.963516 0.894556 0.812830 0.717261 0.604185 0.473237 0.370123 0.272778 0.171410;0.990936 0.885223 0.814433 0.733931 0.628975 0.516658 0.412387 0.327682 0.243360;0.998991 0.956880 0.857587 0.739127 0.598165 0.437458 0.307238 0.187781 0.072082;0.958073 0.851311 0.775434 0.690502 0.584012 0.468361 0.391719 0.313663 0.240892;0.994632 0.899538 0.809479 0.699889 0.556587 0.414508 0.319285 0.229029 0.142622;0.963772 0.858470 0.775702 0.679412 0.571367 0.439828 0.325435 0.230983 0.137796;0.999965 0.932164 0.820674 0.706384 0.552658 0.370404 0.251684 0.141784 0.035585;0.941961 0.851732 0.754278 0.633144 0.506637 0.332626 0.215236 0.103202 0.013160;1.000000 0.984885 0.907611 0.814260 0.711109 0.568430 0.472076 0.394433 0.311886;0.942585 0.858913 0.774674 0.676354 0.545559 0.385608 0.279248 0.180195 0.084960;0.998180 0.944808 0.858429 0.758796 0.642324 0.490804 0.340180 0.241487 0.137840;0.987847 0.936916 0.859047 0.757375 0.654285 0.499092 0.386642 0.306985 0.227507;0.992433 0.909126 0.823532 0.730401 0.622645 0.489496 0.355511 0.273182 0.183382;0.972014 0.828487 0.674489 0.461083 0.313121 0.173899 0.044042 0.000000 0.000000;0.995733 0.817828 0.614073 0.407963 0.155918 0.020961 0.000000 0.000000 0.000000;0.819061 0.607662 0.459659 0.266446 0.130752 0.023888 0.000000 0.000000 0.000000;0.995932 0.822449 0.690765 0.543751 0.387372 0.302983 0.219822 0.118878 0.025864;0.978177 0.763925 0.621029 0.494462 0.312196 0.172123 0.048850 0.000000 0.000000;0.999758 0.851002 0.648969 0.458061 0.177547 0.020757 0.000000 0.000000 0.000000;1.000000 0.999788 0.844711 0.623605 0.409300 0.171514 0.005509 0.000000 0.000000;0.935320 0.706308 0.576523 0.445482 0.279542 0.071869 0.000000 0.000000 0.000000;0.470517 0.217612 0.033536 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000;1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 0.711504 0.056710 0.000000;1.000000 1.000000 1.000000 1.000000 0.999015 0.658718 0.319436 0.008863 0.000000;1.000000 1.000000 1.000000 1.000000 0.846172 0.515508 0.123890 0.000000 0.000000;1.000000 0.665970 0.648252 0.648252 0.569206 0.211855 0.006391 0.000000 0.000000;1.000000 1.000000 1.000000 0.940545 0.567108 0.117877 0.000000 0.000000 0.000000;1.000000 1.000000 0.773987 0.337918 0.065059 0.000000 0.000000 0.000000 0.000000;0.997231 0.691660 0.353189 0.088735 0.000000 0.000000 0.000000 0.000000 0.000000;0.803357 0.447824 0.172892 0.005638 0.000000 0.000000 0.000000 0.000000 0.000000;0.405335 0.156852 0.001111 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000;0.312510 0.116635 0.001042 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000;0.429368 0.185209 0.011603 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000;0.387317 0.162048 0.004052 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000]';
Model1 = [1.000000 1.000000 1.000000 1.000000 0.900782 0.419331 0.047250 0.000000 0.000000;1.000000 1.000000 1.000000 0.999483 0.787912 0.217793 0.000000 0.000000 0.000000;1.000000 1.000000 1.000000 1.000000 0.879832 0.394872 0.012330 0.000000 0.000000;1.000000 1.000000 1.000000 1.000000 0.882802 0.370037 0.061832 0.000000 0.000000;1.000000 1.000000 1.000000 0.981664 0.713894 0.209756 0.000965 0.000000 0.000000;1.000000 1.000000 1.000000 1.000000 0.822449 0.283449 0.003591 0.000000 0.000000;1.000000 1.000000 1.000000 0.947237 0.685814 0.291135 0.015371 0.000000 0.000000;1.000000 1.000000 1.000000 0.998752 0.816129 0.424951 0.124288 0.000000 0.000000;1.000000 1.000000 1.000000 0.985352 0.771625 0.410588 0.085925 0.000000 0.000000;1.000000 1.000000 1.000000 0.996383 0.775762 0.326781 0.057554 0.000000 0.000000;1.000000 1.000000 1.000000 0.975842 0.732520 0.286316 0.035350 0.000000 0.000000;1.000000 1.000000 1.000000 0.999175 0.818875 0.460463 0.139093 0.000000 0.000000;1.000000 1.000000 1.000000 0.995353 0.770087 0.355854 0.081175 0.000000 0.000000;1.000000 1.000000 1.000000 0.994312 0.761495 0.295784 0.009954 0.000000 0.000000;1.000000 1.000000 1.000000 1.000000 0.862993 0.463418 0.148662 0.001334 0.000000;1.000000 1.000000 1.000000 0.981033 0.764557 0.399943 0.116863 0.000000 0.000000;1.000000 1.000000 1.000000 1.000000 0.844889 0.431078 0.107539 0.000464 0.000000;1.000000 1.000000 1.000000 1.000000 0.942725 0.663957 0.230735 0.007020 0.000000;1.000000 1.000000 1.000000 1.000000 0.882436 0.493167 0.110638 0.000000 0.000000;1.000000 1.000000 1.000000 0.895355 0.598069 0.215553 0.003819 0.000000 0.000000;1.000000 1.000000 1.000000 0.999143 0.839095 0.439840 0.138027 0.000428 0.000000;1.000000 1.000000 1.000000 0.984748 0.775645 0.380417 0.105661 0.000000 0.000000;1.000000 1.000000 1.000000 0.994789 0.768899 0.295481 0.015159 0.000000 0.000000;1.000000 1.000000 1.000000 0.998266 0.830470 0.504166 0.121993 0.000000 0.000000;1.000000 1.000000 1.000000 1.000000 0.899032 0.603418 0.230632 0.013310 0.000000;1.000000 1.000000 1.000000 1.000000 0.841657 0.458757 0.079953 0.000000 0.000000;1.000000 1.000000 1.000000 0.998591 0.825942 0.411508 0.077328 0.000000 0.000000;1.000000 1.000000 1.000000 0.922841 0.665071 0.305153 0.066195 0.000000 0.000000;1.000000 1.000000 1.000000 0.990803 0.796075 0.464019 0.151251 0.000000 0.000000;1.000000 1.000000 1.000000 1.000000 0.934533 0.403495 0.000000 0.000000 0.000000;1.000000 1.000000 1.000000 1.000000 0.881912 0.220643 0.000000 0.000000 0.000000;1.000000 1.000000 1.000000 1.000000 0.965027 0.525859 0.007577 0.000000 0.000000;1.000000 1.000000 1.000000 1.000000 0.841904 0.248078 0.000000 0.000000 0.000000]';

C = [];

DB_2 = [-21.001901;-20.006324;-19.006746;-18.002573;-17.008141;-16.006351;-15.000493;-14.003373;-13.003290;-12.003126;-11.001827;-10.009915;-9.008659;-8.004166;-7.007360;-6.003841;-5.002006;-4.009035;-3.001147;-2.001427;-1.009191;-0.001345;0.997259;1.998210;2.999383;3.994471;4.999775;5.998938;6.998252;16.979852;19.946939;25.840419;29.990152;33.000452;34.871319;36.116254;36.546230;36.762792;36.979852;76.979852;116.979852;176.979852];
DB_3 = [-21.001901;-20.006324;-19.006746;-18.002573;-17.008141;-16.006351;-15.000493;-14.003373;-13.003290;-12.003126;-11.001827;-10.009915;-9.008659;-8.004166;-7.007360;-6.003841;-5.002006;-4.009035;-3.001147;-2.001427;-1.009191;-0.001345;0.997259;1.998210;2.999383;3.994471;4.999775;5.998938;6.998252;16.979852;19.946939;36.979852]; 
DB_1 = [-21.001901;-20.006324;-19.006746;-18.002573;-17.008141;-16.006351;-15.000493;-14.003373;-13.003290;-12.003126;-11.001827;-10.009915;-9.008659;-8.004166;-7.007360;-6.003841;-5.002006;-4.009035;-3.001147;-2.001427;-1.009191;-0.001345;0.997259;1.998210;2.999383;3.994471;4.999775;5.998938;6.998252;19.946939;59.948055;116.980969;156.980969]; 
%for i = 1:41
%    C = [C CORRELATION_func(Model2(i,:),Model2(i+1,:))];
%end

TEMP = corrcoef(Model1);
for i = 1:30
    C = [C;TEMP(i+3,i)];
end


x = linspace(-6,6,13);
a = 1-sigmf(x,[10,0]);

DOMAIN_ID = linspace(-21,120,142)
Z = zeros(170,142);
DBR_1 = round(DB_1);
for i = 1:142
    if(DOMAIN_ID(i)-6<=-30)
        t = -30-DOMAIN_ID(i);
        Z(1:13-(6+t),i) = a(7+t:13);
    else if(DOMAIN_ID(i)-6>-30)
            t =  DOMAIN_ID(i)+24;
            Z(1:t,i) = 1;
            Z((t+1):(13+t),i) = a;
        end
        
    end
    
end

IDEAL = [];
TEMP_ID = corrcoef(Z);
for i = 1:139
    IDEAL = [IDEAL;TEMP_ID(i+2,i)];
end

figure(1)
plot(DB_1(3:end),C(1:31));
hold on
plot(DOMAIN_ID(3:end),IDEAL);
%xlim([-10 25]);